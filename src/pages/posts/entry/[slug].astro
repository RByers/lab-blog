---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const posts = await getCollection("posts");
  return posts.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<BaseLayout title={entry.data.title || "Log Entry"}>
  <div class="post-detail">
    <a href={`/posts/${entry.data.date.getFullYear()}`}>&larr; Back to {entry.data.date.getFullYear()} Archive</a>

    <header>
      <h1>{entry.data.title}</h1>
      <p class="date">{entry.data.date.toLocaleString("en-US", { year: "numeric", month: "long", day: "numeric", hour: "2-digit", minute: "2-digit", timeZone: "UTC" })}</p>
    </header>

    <div class="content">
      <Content />
    </div>

    {entry.data.image && <img src={entry.data.image} alt="Attached" />}
  </div>

  <style>
    .content {
      font-size: 1.1rem;
      margin: 2rem 0;
    }
    img {
      max-width: 100%;
      border: 1px solid #333;
    }
  </style>
</BaseLayout>
